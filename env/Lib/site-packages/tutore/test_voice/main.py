from selenium_w import infow
from audio import music
from news import *
import datetime

import pyttsx3 as p
import speech_recognition as sr
import locale

# Définir la langue par défaut en français
locale.setlocale(locale.LC_TIME, 'fr_FR.UTF-8')

engine = p.init()
rate = engine.getProperty('rate')
engine.setProperty('rate', 180)
voices = engine.getProperty('voices')
engine.setProperty('voices',voices[0].id)

def speak(text):
    engine.say(text)
    engine.runAndWait()

today = datetime.datetime.now()

formatted_date = today.strftime("%A, %d %B %Y")

# Affichez la date formatée
speak("Bonjour Monsieur je suis ton assistant vocal")
print("Aujourd'hui est le", formatted_date)

r = sr.Recognizer()

with sr.Microphone() as source :
    r.energy_threshold = 10000
    r.adjust_for_ambient_noise(source,1.2)
    print("j'écoute")
    audio = r.listen(source)
    text = r.recognize_google(audio, language='fr-FR')
    print(text)
    
if "comment" and "tu" and "vas" in text :
    speak("Je vais bien")
speak("Que puis-je faire pour vous ?")

with sr.Microphone() as source :
    r.energy_threshold = 10000
    r.adjust_for_ambient_noise(source,1.2)
    print('J\'écoute...')
    audio = r.listen(source)
    text2 = r.recognize_google(audio, language='fr-FR')
    
if "information" in text2:
    speak("Vous voulez des informations concernant quel sujet ?")
    
    with sr.Microphone() as source :
        r.energy_threshold = 10000
        r.adjust_for_ambient_noise(source,1.2)
        print('J\'écoute...')
        audio = r.listen(source)
        infor = r.recognize_google(audio, language='fr-FR')
    print("Recherche de {} dans wikipedia".format(infor))
    speak("Recherche de {} dans wikipedia".format(infor))
    assist = infow()
    assist.get_info(infor)
    
elif "jouer" and "vidéo" in text2:
    speak("Vous voulez jouer quelle vidéo ?")
    with sr.Microphone() as source :
        r.energy_threshold = 10000
        r.adjust_for_ambient_noise(source,1.2)
        print('J\'écoute...')
        audio = r.listen(source)
        vid = r.recognize_google(audio, language='fr-FR')
    print("Je joue {} dans Youtube".format(vid))
    speak("Je joue {} dans Youtube".format(vid))
    assist = music()
    assist.play(vid) 
    
elif "nouvelles" in text2 :
    print("D'accord Monsieur, Je lierai les informations pour vous")
    speak("D'accord Monsieur, Je lierai les informations pour vous")
    
    arr=news()
    for i in range(len(arr)):
        print(arr[i])
        speak(arr[i])